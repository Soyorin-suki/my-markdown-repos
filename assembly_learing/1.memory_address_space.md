# 内存地址空间
> - 机器语言与汇编语言
> - CPU、存储器与总线
> - 存储单元与内存地址空间
> - 物理地址、段地址与偏移地址
> - 段寄存器与指令寄存器

## 汇编语言
- 汇编语言的主体是汇编指令。
- 汇编指令是机器指令的助记符，是机器指令便于记忆的书写格式

例如：
```assembly
; 机器指令： 1011000010110000
MOV AX,BX		; 将寄存器BX的内容送入寄存器AX
```

### CPU、存储器与总线
CPU通过地址总线、数据总线和控制总线与内存进行通信。

### 存储单元
- 存储器被划分为若干个存储单元，存储单元地址从0开始顺序编号。
- 一个存储单元可以存放一个字节（8位）的信息。
- CPU是通过地址总线来指定存储单元的地址的。
- 地址总线的宽度决定了CPU的寻址能力。
  - 例如：地址总线宽度为16位，则CPU可以寻址2^16=65536个存储单元。
  - 数据总线的宽度决定了CPU每次可以读写的数据量。
  - 控制总线宽度决定了CPU对系统中其他器件的控制能力。

### 8086PC机的内存地址空间分配
- 不同的计算机架构的内存地址空间分配方式不同。
- 从CPU的角度，系统中所有存储器中的存储单元都处于一个统一的逻辑存储器中，它的容量受CPU寻址能力的限制。这个逻辑存储器就是我们所说的内存地址空间。
00000H~9FFFFH：主存储器地址空间（RAM）\
A0000H~BFFFFH：显存地址空间\
C0000H~FFFFFH：各类ROM地址空间（系统BIOS及扩展ROM地址空间）

**8086是16bit架构的CPU**
- 运算器一次最多处理16bit的数据。
- 寄存器的最大宽度为16bit。
- 寄存器和运算器之间的通路是16位的。

### 如何在16bit架构的机器上使用20bit的地址空间？
答案是：使用"段地址:偏移地址(Segment:Offset)"的方式来表示20bit的物理地址。\
即：物理地址 = 段地址 × 16 + 偏移地址

为什么要这样设计？\
因为8086的寄存器宽度是16bit，无法直接存放20bit的地址信息。\
通过"段地址:偏移地址"的方式，可以将20bit的地址信息拆分成两个16bit的部分存放在寄存器中。

为什么段地址要乘以16而非其他数值？\
一个重要原因是内存只有1MB。

内存在物理结构上没有被分段，分段来源于程序，CPU在运行时依据程序的控制以分段的方式来管理和控制内存。

对于同一个物理地址可能存在多种表达方式。

### 段寄存器与指令寄存器
- 段寄存器就是存储段地址的寄存器。8086有4个段寄存器：
- CS：代码段寄存器，存放当前执行代码所在段的段地址。
- DS：数据段寄存器，存放数据段的段地址。
- SS：堆栈段寄存器，存放堆栈段的段地址。
- ES：附加段寄存器，存放附加段的段地址。
- 当8086CPU要访问内存时，由这四个段寄存器提供内存单元的段地址

**CS:IP**

CS和IP是8086CPU中最关键的寄存器，它们指示了CPU当前要读取指令的地址。
- CS（Code Segment Register）：代码段寄存器，存放当前执行代码所在段的段地址。
- IP（Instruction Pointer Register）：指令指针寄存器，存放下一条要执行的指令在代码段内的偏移地址。

