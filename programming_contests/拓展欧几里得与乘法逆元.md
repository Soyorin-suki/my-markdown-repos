# 拓展欧几里得算法与乘法逆元

## 欧几里得算法

> 也是辗转相除法

不失一般性，设$ a\ge b\ge 0 $ 且$ a,b\in\mathbb Z$求$\gcd(a,b)$ 

> gcd最大公约数(Greatest Common Divisor)简称为GCD

存在$a=bq+r,b,r\in \mathbb Z$ 使$\gcd(a,b)=\gcd(b,r)$ ;

则一直迭代可求出$\gcd(a,b)$ ;

计算公式可简记为$\gcd(a,b)=\gcd(b,a\bmod b)$ 

即：

$r_0=r_1\times q_1+r_2$

$r_1=r_2\times q_2+r_3$

$r_2=r_3\times q_3+r_4$

···

$r_{n-2}=r_{n-1}\times q_{n-1}+r_{n}$

$r_{n-1}=r_{n}\times q_n$

此时$r_n=\gcd(a,b)$

```c++
int main(void) {
    int a, b, r=1;
    cin >> a >> b;
    if (a < b)swap(a, b);//保证a>=b
    while (r) {
        r = a % b;
        a = b;
        b = r;
    }
    cout << a;
    return 0;
}
```



## 裴蜀定理

> 得名与于法国数学家艾蒂安·裴蜀
> 
> 又被称为**最大公约数表示定理**或**贝祖定理**

### 内容：

$ \forall a,b,s,t,q\in\mathbb Z ,d=\gcd(a,b),as+bt=dq$ 

特别地，

$ \forall a,b\in \mathbb Z,\exist s,t\in\mathbb Z ,d=\gcd(a,b),as+bt=d$ 

### 重要推论：

a,b互质的**充分必要条件**为$\exists s,t\in\mathbb Z$使$as+bt=1$



## 拓展欧几里得算法

> 

### 内容：

用于求出裴蜀定理中满足$as+bt=\gcd(a,b)$的一组$s$和$t$

在欧几里得算法中，$q_{n}$通常来说没有什么用，但在拓展欧几里得算法中，定义 

$s_0=1,s_1=0,t_0=0,t_1=1$

然后在每一轮迭代中使用以下迭代公式：

$s_{i+1}=s_{i-1}-s_i\times q_i$    与    $t_{i+1}=t_{i-1}-t_i\times q_i$







```c++
int main(void) {
    int a0, b0,a,b, r = 1, q=-1, s0=1, s1=0, t0=0, t1=1;
    int tem;
    cin >> a >> b;
    if (a < b)swap(a, b);//保证a>=b
    a0 = a, b0 = b;
    while (r) {
        r = a % b;
        q = a / b;
        a = b;
        b = r;
        tem = s1;
        s1 = s0 - s1 * q;
        s0 = tem; tem = t1;
        t1 = t0 - t1 * q;
        t0 = tem;
    }
    printf("%d * %d + %d * %d = %d", a0, s0, b0, t0, a);
    return 0;
}
```





## 同余

> congruence

### 定义：

$a\equiv b\pmod n$:设$n$是正整数，若整数$a$和$b$分别模$n$，得到相同的余数，则称$a$与$b$在模$n$情况下满足**同余关系**

> $a\equiv b\pmod n$表示一种关系
> 
> 而$a\bmod b$表示一种运算

### 同余的运算法则

若$a\equiv b\pmod n$且$c\equiv d\pmod n$

- $a+m\equiv b+m\pmod n,m\in\mathbb Z$

- $a\times m\equiv b\times m\pmod n,m\in\mathbb Z$

- $a^m\equiv b^m\pmod n,m\in\mathbb N$

- $a+c\equiv b+d\pmod n$

- $a\times c\equiv b\times d\pmod n$
  
  
  
  

## 乘法逆元

> modular inverse

### 定义

设$a\in\mathbb Z,n\in\mathbb N$,如果$az\equiv 1\pmod n$,称$z$是模$n$下$a$的乘法逆元，记作$a^{-1}=z$

> eg. $2^{-1}\bmod 5=3\bmod 5=1$

注意：一般只考虑比$n$小的乘法逆元

**存在条件：**$\gcd(a,n)=1$



## 求乘法逆元

### 算法：拓展的欧几里得算法

设$\gcd(a,n)=1$

根据裴蜀定理，有

$as+nt=1$

等式两边同时对$n$取模，得

$as\equiv1\pmod n$

易知，$a$的乘法逆元是$s$
