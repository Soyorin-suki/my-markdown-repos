# 原根的定义和性质
## 阶的定义
如果$a$与$m$互质，那么我们将满足$a^k\equiv 1\pmod m$最小$k$称为 **$a$模$m$的阶**。

## 原根(primitive root)的定义
我们将所有的阶等于$\phi(m)$的同余类称为**模m的原根**

$g$是模$m$的原根，当且仅当$g$可以生成所有的可逆元，也就是说任何与m互质的整数a，都可以找到正整数k使得$a\equiv g^k\pmod m$

当$g$是模$m$的原根，那么$g^k$也是模$m$的原根，当且仅当$\gcd(k,\phi(m))=1$

也就是说当找到任意一个原根后可以使用该原根生成其他原根，且可以生成所有的原根。该命题可以由**元素的幂的阶**证明

群论中的元素的幂的阶：$\operatorname{ord}_m(g^k)=\frac{\phi(m)}{\gcd(k,phi(m))}$

## 原根的存在性
并非所有的模数都存在原根。

结论：$m$存在原根当且仅当$m=2,4,p^k,2p^k$，其中$p$是奇素数

证明可参考：https://oi-wiki.org/math/number-theory/primitive-root/#%E5%8E%9F%E6%A0%B9%E5%AD%98%E5%9C%A8%E5%AE%9A%E7%90%86

对于模数$m$，如果其存在原根，那么当且仅当$d\mid\phi(m)$时模$m$的$d$阶元素存在，且恰有$\phi(d)$个；特别的，对于模$m$的原根有$\phi(\phi(m))$个

特别的对于质数$p$，其存在$\phi(\phi(p))=\phi(p-1)$个原根

## 原根判定定理
如果已知$\phi(m)$的所有素因子，则对于$a$是否是$m$的原根是容易判断的

对于整数$m\ge 3$且$\gcd(g,m)=1$，则$g$是$m$的原根，当且仅当对于$\phi(m)$的每个素因子$p$都满足
$$g^{\frac{\phi(m)}{p}}\not\equiv 1\pmod m$$

对于$m$的最小原根$g$是$\Omicron(m^{0.25+\epsilon})$的，因此直接从小到大枚举进行检查是可行的。