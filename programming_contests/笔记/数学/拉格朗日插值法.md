## 插值
插值是指找到一个函数使得这个函数过所给的所有离散点的过程
包括线性插值法、三角函数插值法（周期函数）、牛顿插值法、**拉格朗日插值法**
### 拉格朗日插值法
**拉格朗日插值法（Lagrange Interpolation Polynomial）**的思想非常简单，即为“硬凑”出来一个多项式，使得这n个离散点都在这个多项式上，这种方法叫做**多项式插值**
>多项式插值
>对已知的$n+1$个点$(x_0,y_0),(x_1,y_1),...,(x_n,y_n)$,求$n$阶多项式$f(x)$满足
>$$f(x_i)=y_i,\forall i\in 0,1,...,n$$

拉格朗日插值对于每一个离散点都设计一个子函数$f_i(x)$要求$f_i(x)$在$x=x_i$时取1，在$x=x_j(j\neq i)$时得0，将这$n$个子函数加起来就得到了这个函数。
即我们要计算$n$个函数
$$
f_i(x)=\left\{\begin{matrix}
1&(x=x_i)\\
0&(x=x_j,j\neq i)\\
i\ don\'\ t\ care&othercases
\end{matrix}\right.
$$
那么结果就是
$$f(x)=\sum_{i=1}^n y_if_i(x)$$
因此，我们可以构造
$$
f_i(x)=y_i\cdot\dfrac{\prod_{j\neq i} (x-x_j)}{\prod_{j\neq i} (x_i-x_j)}=y_i\cdot\prod_{j\neq i}\dfrac{x-x_j}{x_i-x_j}
$$
将其加和可以得到
$$
f(x)=\sum_{i=1}^ny_i\cdot\prod_{j\neq i}\dfrac{x-x_j}{x_i-x_j}
$$
朴素实现为$O(n^2)$,使用FFT加速可以达到$O(nlog_2n)$
[Luogu P4781【模板】拉格朗日插值](https://www.luogu.com.cn/problem/P4781)
```c++
// 朴素拉格朗日插值O(n2)
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const ll N=2e5+10;
const ll INF=1e11+10;
const ll MOD=998244353;
ll n,k;
ll x[N],y[N],a[N];
ll q_pow(ll base,ll p){
	ll ret=1;
	while(p){
		if(p&1LL)ret=ret*base%MOD;
		base=base*base%MOD;
		p>>=1;
	}
	return ret;
}
inline ll inv(ll x){
	return q_pow(x,MOD-2);
}
void solve(void){
	cin>>n>>k;
	for(ll i=1;i<=n;++i){
		cin>>x[i]>>y[i];
	}
	ll ans=0;
	for(ll i=1;i<=n;++i){
		ll tmp=y[i];
		for(ll i2=1;i2<=n;++i2){
			if(i==i2)continue;
			tmp=(tmp*inv((x[i]-x[i2]+MOD)%MOD))%MOD;
		}
		for(ll i2=1;i2<=n;++i2){
			if(i==i2)continue;
			tmp=(tmp*((k-x[i2]+MOD)%MOD))%MOD;
		}
		ans=(tmp+ans)%MOD;
	}
	cout<<ans<<endl;


}
int main(void){
	ios::sync_with_stdio(0);
	cin.tie(0);cout.tie(0);
	ll times=1;
	// cin>>times;
	while(times--)solve();
	return 0;
}
```
### 横坐标是连续整数的拉格朗日插值
对于横坐标为连续整数的情况下上述求$f_i(x)$的式子就变成了：
$$
f_i(x)=y_i\cdot\dfrac{\prod_{j\neq i} (x-j)}{\prod_{j\neq i} (i-j)}=y_i\cdot\prod_{j\neq i}\dfrac{x-j}{i-j}
$$
分子即为
$$
y_i\cdot \dfrac{\prod{(x-j)}}{x-i}
$$
可通过前缀积和后缀积实现
分母则可以转化为两个阶乘实现（注意符号）
$$
(-1)^{(n-i)}\cdot (i-1)!\cdot (n-i)!
$$
时间复杂度为$O(n)$
[The Sum of the k-th Power](https://codeforces.com/contest/622/problem/F)
代码：https://codeforces.com/contest/622/submission/282658843
### 重心拉格朗日插值法
以后再学
https://blog.wingszeng.top/lagrange-interpolation/#%E9%87%8D%E5%BF%83%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC%E6%B3%95


参考文献：
https://www.cnblogs.com/crashed/p/13124448.html
https://oi-wiki.org/math/numerical/interp/#lagrange-%E6%8F%92%E5%80%BC%E6%B3%95